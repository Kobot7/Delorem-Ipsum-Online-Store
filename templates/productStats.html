{% extends "admin_base.html" %}
{% block title %}Product Statistics{% endblock %}
{% block style %}<link rel="stylesheet" href="/static/styles/productStats.css">{% endblock %}

{% block headScript %}
{% endblock %}

{% block content %}
<div class="row justify-content-center mt-4">
  <div class="col-md-11">
    <h1 class="d-inline">Product Statistics</h1>

    <ul class="nav nav-tabs my-4">
      <li class="nav-item active"><a class="nav-link active" href="#table" data-toggle="tab">Table</a></li>
      <li class="nav-item"><a class="nav-link" href="#bargraph" data-toggle="tab">Graph</a></li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane active in" id="table">
        <table class="table mt-4 products">
          <thead>
            <tr>
              <th>Thumbnail</th>
              <th>Name <a href="/productStats/name/ascending"><i class="fa fa-caret-up" aria-hidden="true"></i></a>
                       <a href="/productStats/name/descending"><i class="fa fa-caret-down" aria-hidden="true"></i></a>
              </th>
              <th>Serial No. <a href="/productStats/serial-no/ascending"><i class="fa fa-caret-up" aria-hidden="true"></i></a>
                       <a href="/productStats/serial-no/descending"><i class="fa fa-caret-down" aria-hidden="true"></i></a>
              </th>
              <th>Purchases <a href="/productStats/purchase/ascending"><i class="fa fa-caret-up" aria-hidden="true"></i></a>
                       <a href="/productStats/purchase/descending"><i class="fa fa-caret-down" aria-hidden="true"></i></a>
              </th>
              <th>Views <a href="/productStats/view/ascending"><i class="fa fa-caret-up" aria-hidden="true"></i></a>
                       <a href="/productStats/view/descending"><i class="fa fa-caret-down" aria-hidden="true"></i></a>
              </th>
          </thead>

          <tbody>
            {% for product in productList %}
              <tr>
                <td><img class="thumbnail" src="/static/images/{{ product.get_thumbnail() }}" alt="thumbnail"></td>
                <td>{{ product.get_product_name() }}</td>
                <td>{{ product.get_serial_no() }}</td>
                <td>{{ product.get_purchases() }}</td>
                <td>{{ product.get_views() }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div> <!--Tab Content-->

      <div class="tab-pane fade pb-4" id="bargraph">
      </div> <!--Tab Content-->
        <script>
          function getWidth() {
            return Math.max(
              document.body.scrollWidth,
              document.documentElement.scrollWidth,
              document.body.offsetWidth,
              document.documentElement.offsetWidth,
              document.documentElement.clientWidth
            );
          }
          var graph = {{graphJSON | safe}};
          var heightValue = {{ productList|length }}*60;
          var widthValue = getWidth() - 200;
          graph.layout = { yaxis: {automargin: true}, margin: {t:50, b:50}, height: heightValue, width: widthValue};
          var chart = Plotly.plot("bargraph", graph.data, graph.layout, {responsive: true});
        </script>
    </div> <!--Nav Tabs-->
  </div>
</div>

{% endblock %}

{% block scripts %}

{% endblock %}
